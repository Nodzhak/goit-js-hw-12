{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\nconst loader = document.querySelector('.loader');\nconst searchFormElement = document.querySelector('.form');\nconst galleryContainerElement = document.querySelector('.gallery');\nconst loadMoreButtonElement = document.querySelector('.load-more');\nlet galleryLightbox;\n\nconst fetchData = async searchParams => {\n  const response = await axios.get('https://pixabay.com/api/', {\n    params: searchParams,\n  });\n  return response;\n};\n\nconst handleFetchData = async (searchParams) => {\n  try {\n    const response = await fetchData(searchParams);\n    const totalPages = Math.ceil(response.data.totalHits / 40);\n\n    if (searchParams.page === totalPages) {\n      iziToast.error({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      loadMoreButtonElement.style.display = 'none';\n      loader.style.display = 'none';\n    }\n\n    const json = response.data;\n    const galleryMarkup = generateGalleryHTML(json.hits);\n\n    if (galleryMarkup.length < 1) {\n      iziToast.error({\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      loader.style.display = 'none';\n    } else {\n      galleryContainerElement.insertAdjacentHTML('beforeend', galleryMarkup);\n\n      if (searchParams.page < Math.ceil(json.totalHits / 40)) {\n        loadMoreButtonElement.style.display = 'block';\n      }\n\n      loader.style.display = 'none';\n\n      if (galleryLightbox) {\n        galleryLightbox.refresh();\n      }\n\n      if (searchParams.page > 1) {\n        window.scrollBy({\n          top: 2 * document.querySelector('.gallery-item').getBoundingClientRect().height,\n          behavior: 'smooth',\n        });\n      }\n    }\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nlet searchParams = {\n  key: '41631198-f5cd04d694ed896bf4215baa6',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  page: 1,\n  per_page: 40,\n};\n\nconst handleSubmitForm = event => {\n  event.preventDefault();\n  loadMoreButtonElement.style.display = 'none';\n  if (galleryContainerElement.children.length > 0) galleryContainerElement.innerHTML = '';\n  loader.style.display = 'inline-block';\n  const searchQueryValue = searchFormElement.searchQuery.value;\n\n  if (searchQueryValue.includes(' ')) {\n    iziToast.error({\n      message: 'Search query cannot contain spaces. Please try again!',\n      position: 'topRight',\n    });\n    loader.style.display = 'none';\n    return;\n  }\n\n  searchParams.q = searchQueryValue;\n  searchParams.page = 1;\n  searchFormElement.reset();\n  handleFetchData(searchParams);\n};\n\nconst handleNextElements = () => {\n  loader.style.display = 'inline-block';\n  searchParams.page++;\n  handleFetchData(searchParams);\n};\n\nsearchFormElement.addEventListener('submit', handleSubmitForm);\nloadMoreButtonElement.addEventListener('click', handleNextElements);\n\nfunction generateGalleryHTML(hits) {\n  return hits.reduce((html, hit) => {\n    const { largeImageURL, webformatURL, tags, likes, views, comments, downloads } = hit;\n    return (\n      html +\n      `<li class=\"gallery-item\">\n        <a href=\"${largeImageURL}\"> \n          <img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\" />\n        </a>\n        <div class=\"gallery-text-box\">\n          <p>Likes: <span class=\"text-value\">${likes}</span></p>\n          <p>Views: <span class=\"text-value\">${views}</span></p>\n          <p>Comments: <span class=\"text-value\">${comments}</span></p>\n          <p>Downloads: <span class=\"text-value\">${downloads}</span></p>\n        </div>\n      </li>`\n    );\n  }, '');\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  galleryLightbox = new SimpleLightbox('.gallery a');\n});\n\n\n"],"names":["loader","searchFormElement","galleryContainerElement","loadMoreButtonElement","galleryLightbox","fetchData","searchParams","axios","handleFetchData","response","totalPages","iziToast","json","galleryMarkup","generateGalleryHTML","err","handleSubmitForm","event","searchQueryValue","handleNextElements","hits","html","hit","largeImageURL","webformatURL","tags","likes","views","comments","downloads","SimpleLightbox"],"mappings":"owBAMA,MAAMA,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAoB,SAAS,cAAc,OAAO,EAClDC,EAA0B,SAAS,cAAc,UAAU,EAC3DC,EAAwB,SAAS,cAAc,YAAY,EACjE,IAAIC,EAEJ,MAAMC,EAAY,MAAMC,GACL,MAAMC,EAAM,IAAI,2BAA4B,CAC3D,OAAQD,CACZ,CAAG,EAIGE,EAAkB,MAAOF,GAAiB,CAC9C,GAAI,CACF,MAAMG,EAAW,MAAMJ,EAAUC,CAAY,EACvCI,EAAa,KAAK,KAAKD,EAAS,KAAK,UAAY,EAAE,EAErDH,EAAa,OAASI,IACxBC,EAAS,MAAM,CACb,QAAS,6DACT,SAAU,UAClB,CAAO,EACDR,EAAsB,MAAM,QAAU,OACtCH,EAAO,MAAM,QAAU,QAGzB,MAAMY,EAAOH,EAAS,KAChBI,EAAgBC,EAAoBF,EAAK,IAAI,EAE/CC,EAAc,OAAS,GACzBF,EAAS,MAAM,CACb,QAAS,2EACT,SAAU,UAClB,CAAO,EACDX,EAAO,MAAM,QAAU,SAEvBE,EAAwB,mBAAmB,YAAaW,CAAa,EAEjEP,EAAa,KAAO,KAAK,KAAKM,EAAK,UAAY,EAAE,IACnDT,EAAsB,MAAM,QAAU,SAGxCH,EAAO,MAAM,QAAU,OAEnBI,GACFA,EAAgB,QAAO,EAGrBE,EAAa,KAAO,GACtB,OAAO,SAAS,CACd,IAAK,EAAI,SAAS,cAAc,eAAe,EAAE,sBAAqB,EAAG,OACzE,SAAU,QACpB,CAAS,EAGN,OAAQS,EAAP,CACA,QAAQ,IAAIA,CAAG,CAChB,CACH,EAEA,IAAIT,EAAe,CACjB,IAAK,qCACL,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAM,EACN,SAAU,EACZ,EAEA,MAAMU,EAAmBC,GAAS,CAChCA,EAAM,eAAc,EACpBd,EAAsB,MAAM,QAAU,OAClCD,EAAwB,SAAS,OAAS,IAAGA,EAAwB,UAAY,IACrFF,EAAO,MAAM,QAAU,eACvB,MAAMkB,EAAmBjB,EAAkB,YAAY,MAEvD,GAAIiB,EAAiB,SAAS,GAAG,EAAG,CAClCP,EAAS,MAAM,CACb,QAAS,wDACT,SAAU,UAChB,CAAK,EACDX,EAAO,MAAM,QAAU,OACvB,MACD,CAEDM,EAAa,EAAIY,EACjBZ,EAAa,KAAO,EACpBL,EAAkB,MAAK,EACvBO,EAAgBF,CAAY,CAC9B,EAEMa,EAAqB,IAAM,CAC/BnB,EAAO,MAAM,QAAU,eACvBM,EAAa,OACbE,EAAgBF,CAAY,CAC9B,EAEAL,EAAkB,iBAAiB,SAAUe,CAAgB,EAC7Db,EAAsB,iBAAiB,QAASgB,CAAkB,EAElE,SAASL,EAAoBM,EAAM,CACjC,OAAOA,EAAK,OAAO,CAACC,EAAMC,IAAQ,CAChC,KAAM,CAAE,cAAAC,EAAe,aAAAC,EAAc,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,EAAGP,EACjF,OACED,EACA;AAAA,mBACaE;AAAA,0CACuBC,WAAsBC;AAAA;AAAA;AAAA,+CAGjBC;AAAA,+CACAC;AAAA,kDACGC;AAAA,mDACCC;AAAA;AAAA,YAIhD,EAAE,EAAE,CACP,CAEA,SAAS,iBAAiB,mBAAoB,IAAM,CAClDzB,EAAkB,IAAI0B,EAAe,YAAY,CACnD,CAAC"}