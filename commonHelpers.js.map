{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\nconst loaderElement = document.querySelector('.loader');\nconst searchForm = document.querySelector('.form');\nconst galleryContainer = document.querySelector('.gallery');\nconst loadMoreButton = document.querySelector('.load-more');\nlet gallery;\n\nconst fetchCart = async searchParamsDefaults => {\n  const response = await axios.get(`https://pixabay.com/api/`, {\n    params: searchParamsDefaults,\n  });\n  return response;\n};\n\nconst thenCatch = searchParamsDefaults => {\n  fetchCart(searchParamsDefaults)\n    .then(response => {\n      if (searchParamsDefaults.page === Math.ceil(response.data.totalHits / 40)) {\n        iziToast.error({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'center',\n        });\n        loadMoreButton.style.display = 'none';\n        loaderElement.style.display = 'none';\n      }\n      return response.data;\n    })\n    .then(json => {\n      const marcup = generateGalleryHTML(json.hits);\n      if (marcup.length < 1) {\n        iziToast.error({\n          message: 'Sorry, there are no images matching your search query. Please try again!',\n          position: 'center',\n        });\n        loaderElement.style.display = 'none';\n      } else {\n        galleryContainer.insertAdjacentHTML('beforeend', marcup);\n        if (searchParamsDefaults.page < Math.ceil(json.totalHits / 40)) {\n          loadMoreButton.style.display = 'block';\n        }\n\n        loaderElement.style.display = 'none';\n        if (gallery) {\n          gallery.refresh();\n        }\n        if (searchParamsDefaults.page > 1) {\n          window.scrollBy({\n            top: 2 * document.querySelector('.gallery-item').getBoundingClientRect().height,\n            behavior: 'smooth',\n          });\n        }\n      }\n    })\n    .catch(err => {\n      console.log(err);\n    });\n};\n\nlet searchParamsDefaults = {\n  key: '41631198-f5cd04d694ed896bf4215baa6',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  page: 1,\n  per_page: 40,\n};\n\nconst formSubmit = event => {\n  event.preventDefault();\n  loadMoreButton.style.display = 'none';\n  if (galleryContainer.children.length > 0) galleryContainer.innerHTML = '';\n  loaderElement.style.display = 'inline-block';\n  searchParamsDefaults.q = searchForm.searchQuery.value;\n  searchParamsDefaults.page = 1;\n  searchForm.reset();\n  thenCatch(searchParamsDefaults);\n};\n\nconst nextElements = () => {\n  loaderElement.style.display = 'inline-block';\n  searchParamsDefaults.page++;\n  thenCatch(searchParamsDefaults);\n};\n\nsearchForm.addEventListener('submit', formSubmit);\nloadMoreButton.addEventListener('click', nextElements);\n\nfunction generateGalleryHTML(hits) {\n  return hits.reduce((html, hit) => {\n    const { largeImageURL, webformatURL, tags, likes, views, comments, downloads } = hit;\n    return (\n      html +\n      `<li class=\"gallery-item\">\n        <a href=\"${largeImageURL}\"> \n          <img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\" />\n        </a>\n        <div class=\"gallery-text-box\">\n          <p>Likes: <span class=\"text-value\">${likes}</span></p>\n          <p>Views: <span class=\"text-value\">${views}</span></p>\n          <p>Comments: <span class=\"text-value\">${comments}</span></p>\n          <p>Downloads: <span class=\"text-value\">${downloads}</span></p>\n        </div>\n      </li>`\n    );\n  }, '');\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  gallery = new SimpleLightbox('.gallery a');\n});"],"names":["loaderElement","searchForm","galleryContainer","loadMoreButton","gallery","fetchCart","searchParamsDefaults","axios","thenCatch","response","iziToast","json","marcup","generateGalleryHTML","err","formSubmit","event","nextElements","hits","html","hit","largeImageURL","webformatURL","tags","likes","views","comments","downloads","SimpleLightbox"],"mappings":"owBAMA,MAAMA,EAAgB,SAAS,cAAc,SAAS,EAChDC,EAAa,SAAS,cAAc,OAAO,EAC3CC,EAAmB,SAAS,cAAc,UAAU,EACpDC,EAAiB,SAAS,cAAc,YAAY,EAC1D,IAAIC,EAEJ,MAAMC,EAAY,MAAMC,GACL,MAAMC,EAAM,IAAI,2BAA4B,CAC3D,OAAQD,CACZ,CAAG,EAIGE,EAAYF,GAAwB,CACxCD,EAAUC,CAAoB,EAC3B,KAAKG,IACAH,EAAqB,OAAS,KAAK,KAAKG,EAAS,KAAK,UAAY,EAAE,IACtEC,EAAS,MAAM,CACb,QAAS,6DACT,SAAU,QACpB,CAAS,EACDP,EAAe,MAAM,QAAU,OAC/BH,EAAc,MAAM,QAAU,QAEzBS,EAAS,KACjB,EACA,KAAKE,GAAQ,CACZ,MAAMC,EAASC,EAAoBF,EAAK,IAAI,EACxCC,EAAO,OAAS,GAClBF,EAAS,MAAM,CACb,QAAS,2EACT,SAAU,QACpB,CAAS,EACDV,EAAc,MAAM,QAAU,SAE9BE,EAAiB,mBAAmB,YAAaU,CAAM,EACnDN,EAAqB,KAAO,KAAK,KAAKK,EAAK,UAAY,EAAE,IAC3DR,EAAe,MAAM,QAAU,SAGjCH,EAAc,MAAM,QAAU,OAC1BI,GACFA,EAAQ,QAAO,EAEbE,EAAqB,KAAO,GAC9B,OAAO,SAAS,CACd,IAAK,EAAI,SAAS,cAAc,eAAe,EAAE,sBAAqB,EAAG,OACzE,SAAU,QACtB,CAAW,EAGX,CAAK,EACA,MAAMQ,GAAO,CACZ,QAAQ,IAAIA,CAAG,CACrB,CAAK,CACL,EAEA,IAAIR,EAAuB,CACzB,IAAK,qCACL,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAM,EACN,SAAU,EACZ,EAEA,MAAMS,EAAaC,GAAS,CAC1BA,EAAM,eAAc,EACpBb,EAAe,MAAM,QAAU,OAC3BD,EAAiB,SAAS,OAAS,IAAGA,EAAiB,UAAY,IACvEF,EAAc,MAAM,QAAU,eAC9BM,EAAqB,EAAIL,EAAW,YAAY,MAChDK,EAAqB,KAAO,EAC5BL,EAAW,MAAK,EAChBO,EAAUF,CAAoB,CAChC,EAEMW,EAAe,IAAM,CACzBjB,EAAc,MAAM,QAAU,eAC9BM,EAAqB,OACrBE,EAAUF,CAAoB,CAChC,EAEAL,EAAW,iBAAiB,SAAUc,CAAU,EAChDZ,EAAe,iBAAiB,QAASc,CAAY,EAErD,SAASJ,EAAoBK,EAAM,CACjC,OAAOA,EAAK,OAAO,CAACC,EAAMC,IAAQ,CAChC,KAAM,CAAE,cAAAC,EAAe,aAAAC,EAAc,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,EAAGP,EACjF,OACED,EACA;AAAA,mBACaE;AAAA,0CACuBC,WAAsBC;AAAA;AAAA;AAAA,+CAGjBC;AAAA,+CACAC;AAAA,kDACGC;AAAA,mDACCC;AAAA;AAAA,YAIhD,EAAE,EAAE,CACP,CAEA,SAAS,iBAAiB,mBAAoB,IAAM,CAClDvB,EAAU,IAAIwB,EAAe,YAAY,CAC3C,CAAC"}